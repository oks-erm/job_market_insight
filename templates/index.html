<!DOCTYPE html>
<html>

<head>
    <title>Job Search</title>
    <link rel="stylesheet" href="static/css/style.css">
</head>

<body>
    <h1>Job Search Results</h1>
    <div id="searchFormContainer">
        <form id="searchForm">
            <label for="keywords">Keywords:</label>
            <input type="text" id="keywordsInput" name="keywords" required>
            <br>
            <label for="location">Location:</label>
            <input type="text" id="locationInput" name="location" required>
            <br>
            <button type="submit">Search</button>
        </form>
    </div>
    <div id="loader" style="display: none;">
        <div class="loading">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
    <div id="resultsContainer" style="display: none;">
        <p>Location: <span id="location"></span></p>
        <p>Keyword: <span id="keywords"></span></p>
    </div>
    <div id="plotContainer" style="display: none;">
        <img id="plotImg" src="" alt="Plot">
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $('#searchForm').submit(function (event) {
            event.preventDefault();  // Prevent the form from submitting normally

            // Get the form values
            var keywords = $('#keywordsInput').val();
            var location = $('#locationInput').val();

            // Show the loader
            $('#loader').show();
            $('#resultsContainer').hide();
            $('#plotContainer').hide();
            $('#plotImg').attr('src', '');

            // Send AJAX request to the Flask backend
            $.ajax({
                url: '/search',
                type: 'GET',
                data: { keywords: keywords, location: location },
                success: function (data) {
                    // Hide the loader and show the results container
                    $('#loader').hide();
                    $('#resultsContainer').show();
                    // Display the results and plot
                    $('#location').text(location);
                    $('#keywords').text(keywords);
                    // displayJobData(data.job_data);
                    $('#plotImg').attr('src', data.plot_path);
                    $('#plotContainer').show();
                },
                error: function () {
                    $('#loader').hide();
                    alert('An error occurred while searching for jobs.');
                }
            });
        });
    </script>

</body>

</html>

